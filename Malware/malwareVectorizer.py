import os
import pandas as pd
from sklearn.feature_extraction.text import CountVectorizer

path = 'log_files'

labels = []
text = []

for filename in os.listdir(path):
    if 'Good' in filename:
        labels.append('1')
    else:
        labels.append('-1')
    filename = os.path.join(path, filename)
    print(filename)
    with open(filename, encoding='utf-8') as f:
        content = f.read()
    content.replace(',', ' ')
    content.replace('"', ' ')
    text.append(content)

vectorizer = CountVectorizer(stop_words='english', max_features=1000)

dtm = vectorizer.fit_transform(text)

df = pd.DataFrame(str(dtm), index=labels, columns=vectorizer.get_feature_names_out())

df.index.name = "labels"

df.to_csv(r'DynamicMalwareMatrix.csv')

feature_list = vectorizer.get_feature_names_out()
for feature in feature_list:
    print(str(feature))
